<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 15 Funktionales Programmieren | R für empirische Wissenschaften</title>
  <meta name="description" content="Das ist ein Test" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 15 Funktionales Programmieren | R für empirische Wissenschaften" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Das ist ein Test" />
  <meta name="github-repo" content="j3ypi/rBasics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 15 Funktionales Programmieren | R für empirische Wissenschaften" />
  
  <meta name="twitter:description" content="Das ist ein Test" />
  

<meta name="author" content="Jan Philipp Nolte" />


<meta name="date" content="2020-08-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reproduzierbare-berichte.html"/>
<link rel="next" href="namespace.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./"> R für empirische Wissenschaften</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Vorwort</a></li>
<li class="part"><span><b>I Die ersten Schritte</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Einleitung</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#für-wen-ist-dieses-buch"><i class="fa fa-check"></i><b>1.1</b> Für wen ist dieses Buch?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#aufbau-und-bearbeitungsstrategie"><i class="fa fa-check"></i><b>1.2</b> Aufbau und Bearbeitungsstrategie</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#boxen-übungen-und-datensätze"><i class="fa fa-check"></i><b>1.3</b> Boxen, Übungen und Datensätze</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#books"><i class="fa fa-check"></i><b>1.4</b> Ergänzende Literatur</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start.html"><a href="start.html"><i class="fa fa-check"></i><b>2</b> Startvoraussetzungen</a><ul>
<li class="chapter" data-level="2.1" data-path="start.html"><a href="start.html#installation-von-r-und-rstudio"><i class="fa fa-check"></i><b>2.1</b> Installation von R und RStudio</a><ul>
<li class="chapter" data-level="2.1.1" data-path="start.html"><a href="start.html#programmiersprache-r"><i class="fa fa-check"></i><b>2.1.1</b> Programmiersprache R</a></li>
<li class="chapter" data-level="2.1.2" data-path="start.html"><a href="start.html#rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Programmierumgebung RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start.html"><a href="start.html#aufbau"><i class="fa fa-check"></i><b>2.2</b> Aufbau von RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="start.html"><a href="start.html#anpassung"><i class="fa fa-check"></i><b>2.3</b> RStudio anpassen</a></li>
<li class="chapter" data-level="2.4" data-path="start.html"><a href="start.html#funktionen-und-ihre-argumente"><i class="fa fa-check"></i><b>2.4</b> Funktionen und ihre Argumente</a></li>
<li class="chapter" data-level="2.5" data-path="start.html"><a href="start.html#packages"><i class="fa fa-check"></i><b>2.5</b> Packages (Erweiterungen)</a><ul>
<li class="chapter" data-level="2.5.1" data-path="start.html"><a href="start.html#packages-installieren-und-laden"><i class="fa fa-check"></i><b>2.5.1</b> Packages installieren und laden</a></li>
<li class="chapter" data-level="2.5.2" data-path="start.html"><a href="start.html#installieren-der-notwendigen-packages"><i class="fa fa-check"></i><b>2.5.2</b> Installieren der notwendigen Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="start.html"><a href="start.html#help"><i class="fa fa-check"></i><b>2.6</b> Fehler- und Warnmeldungen</a></li>
<li class="chapter" data-level="2.7" data-path="start.html"><a href="start.html#hilfe"><i class="fa fa-check"></i><b>2.7</b> Wo bekomme ich Hilfe?</a></li>
<li class="chapter" data-level="2.8" data-path="start.html"><a href="start.html#tu-das-nie"><i class="fa fa-check"></i><b>2.8</b> Tu das nie!</a></li>
</ul></li>
<li class="part"><span><b>II Vorbereitung</b></span></li>
<li class="chapter" data-level="3" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i><b>3</b> Projektorientierung</a><ul>
<li class="chapter" data-level="3.1" data-path="project.html"><a href="project.html#wo-liegt-das-problem"><i class="fa fa-check"></i><b>3.1</b> Wo liegt das Problem?</a></li>
<li class="chapter" data-level="3.2" data-path="project.html"><a href="project.html#r-projekte-erstellen"><i class="fa fa-check"></i><b>3.2</b> R Projekte erstellen</a></li>
<li class="chapter" data-level="3.3" data-path="project.html"><a href="project.html#here"><i class="fa fa-check"></i><b>3.3</b> Das <code>here</code> Package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pfeil.html"><a href="pfeil.html"><i class="fa fa-check"></i><b>4</b> Variablen</a></li>
<li class="chapter" data-level="5" data-path="io.html"><a href="io.html"><i class="fa fa-check"></i><b>5</b> Datensätze</a><ul>
<li class="chapter" data-level="5.1" data-path="io.html"><a href="io.html#einlesen-externer-dateien"><i class="fa fa-check"></i><b>5.1</b> Einlesen externer Dateien</a></li>
<li class="chapter" data-level="5.2" data-path="io.html"><a href="io.html#datensätze-aus-packages-laden"><i class="fa fa-check"></i><b>5.2</b> Datensätze aus Packages laden</a></li>
<li class="chapter" data-level="5.3" data-path="io.html"><a href="io.html#speichern-und-konvertieren"><i class="fa fa-check"></i><b>5.3</b> Speichern und Konvertieren</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="datentypen.html"><a href="datentypen.html"><i class="fa fa-check"></i><b>6</b> Datentypen</a><ul>
<li class="chapter" data-level="6.1" data-path="datentypen.html"><a href="datentypen.html#grundtypen"><i class="fa fa-check"></i><b>6.1</b> Grundtypen</a></li>
<li class="chapter" data-level="6.2" data-path="datentypen.html"><a href="datentypen.html#datentypen-konvertieren"><i class="fa fa-check"></i><b>6.2</b> Datentypen konvertieren</a></li>
<li class="chapter" data-level="6.3" data-path="datentypen.html"><a href="datentypen.html#factor"><i class="fa fa-check"></i><b>6.3</b> Faktoren</a></li>
<li class="chapter" data-level="6.4" data-path="datentypen.html"><a href="datentypen.html#zeitdaten"><i class="fa fa-check"></i><b>6.4</b> Zeitdaten</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html"><i class="fa fa-check"></i><b>7</b> Datenvorbereitung</a><ul>
<li class="chapter" data-level="7.1" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#tidyverse"><i class="fa fa-check"></i><b>7.1</b> Einführung</a></li>
<li class="chapter" data-level="7.2" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#select-rename-und-relocate"><i class="fa fa-check"></i><b>7.2</b> select(), rename() und relocate()</a></li>
<li class="chapter" data-level="7.3" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#across"><i class="fa fa-check"></i><b>7.3</b> across()</a></li>
<li class="chapter" data-level="7.4" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#filter-und-arrange"><i class="fa fa-check"></i><b>7.4</b> filter() und arrange()</a></li>
<li class="chapter" data-level="7.5" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#mutate"><i class="fa fa-check"></i><b>7.5</b> group_by() und mutate()</a></li>
<li class="chapter" data-level="7.6" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#eigene-funktionen"><i class="fa fa-check"></i><b>7.6</b> Eigene Funktionen</a></li>
<li class="chapter" data-level="7.7" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#rowwise-und-c_across"><i class="fa fa-check"></i><b>7.7</b> rowwise() und c_across()</a></li>
<li class="chapter" data-level="7.8" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#tidy"><i class="fa fa-check"></i><b>7.8</b> Breites und langes Datenformat</a></li>
<li class="chapter" data-level="7.9" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#spalten-trennen"><i class="fa fa-check"></i><b>7.9</b> Spalten trennen</a></li>
<li class="chapter" data-level="7.10" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datensätze-zusammenführen"><i class="fa fa-check"></i><b>7.10</b> Datensätze zusammenführen</a></li>
<li class="chapter" data-level="7.11" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datastring"><i class="fa fa-check"></i><b>7.11</b> Character Manipulation</a></li>
<li class="chapter" data-level="7.12" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datafactor"><i class="fa fa-check"></i><b>7.12</b> Faktoren verändern</a></li>
<li class="chapter" data-level="7.13" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#datazeit"><i class="fa fa-check"></i><b>7.13</b> Mit Zeitdaten arbeiten</a></li>
<li class="chapter" data-level="7.14" data-path="datenvorbereitung.html"><a href="datenvorbereitung.html#binäre-antwortmatrix-erstellen"><i class="fa fa-check"></i><b>7.14</b> Binäre Antwortmatrix erstellen</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fehler-berichten-und-beheben.html"><a href="fehler-berichten-und-beheben.html"><i class="fa fa-check"></i><b>8</b> Fehler berichten und beheben</a></li>
<li class="part"><span><b>III Auswertung</b></span></li>
<li class="chapter" data-level="9" data-path="deskriptive-statistik.html"><a href="deskriptive-statistik.html"><i class="fa fa-check"></i><b>9</b> Deskriptive Statistik</a><ul>
<li class="chapter" data-level="9.1" data-path="deskriptive-statistik.html"><a href="deskriptive-statistik.html#summarise-und-descriptive"><i class="fa fa-check"></i><b>9.1</b> summarise() und descriptive()</a></li>
<li class="chapter" data-level="9.2" data-path="deskriptive-statistik.html"><a href="deskriptive-statistik.html#nesten"><i class="fa fa-check"></i><b>9.2</b> Nesten</a></li>
<li class="chapter" data-level="9.3" data-path="deskriptive-statistik.html"><a href="deskriptive-statistik.html#umgang-mit-fehlenden-werten"><i class="fa fa-check"></i><b>9.3</b> Umgang mit fehlenden Werten</a></li>
<li class="chapter" data-level="9.4" data-path="deskriptive-statistik.html"><a href="deskriptive-statistik.html#häufigkeiten-und-kontingenztafeln"><i class="fa fa-check"></i><b>9.4</b> Häufigkeiten und Kontingenztafeln</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="visual.html"><a href="visual.html"><i class="fa fa-check"></i><b>10</b> Visualisierungen</a><ul>
<li class="chapter" data-level="10.1" data-path="visual.html"><a href="visual.html#einführung"><i class="fa fa-check"></i><b>10.1</b> Einführung</a></li>
<li class="chapter" data-level="10.2" data-path="visual.html"><a href="visual.html#histogram"><i class="fa fa-check"></i><b>10.2</b> Histogramm und Dichte</a></li>
<li class="chapter" data-level="10.3" data-path="visual.html"><a href="visual.html#streudiagramm"><i class="fa fa-check"></i><b>10.3</b> Streudiagramm</a></li>
<li class="chapter" data-level="10.4" data-path="visual.html"><a href="visual.html#boxplot"><i class="fa fa-check"></i><b>10.4</b> Boxplot</a></li>
<li class="chapter" data-level="10.5" data-path="visual.html"><a href="visual.html#violin"><i class="fa fa-check"></i><b>10.5</b> Violin Plot</a></li>
<li class="chapter" data-level="10.6" data-path="visual.html"><a href="visual.html#barplot"><i class="fa fa-check"></i><b>10.6</b> Balkendiagramm</a></li>
<li class="chapter" data-level="10.7" data-path="visual.html"><a href="visual.html#anovaplot"><i class="fa fa-check"></i><b>10.7</b> Liniendiagramm</a></li>
<li class="chapter" data-level="10.8" data-path="visual.html"><a href="visual.html#odds"><i class="fa fa-check"></i><b>10.8</b> Odds Ratios</a></li>
<li class="chapter" data-level="10.9" data-path="visual.html"><a href="visual.html#ellipsen"><i class="fa fa-check"></i><b>10.9</b> Ellipsen</a></li>
<li class="chapter" data-level="10.10" data-path="visual.html"><a href="visual.html#mehrfaktorielle-abbildungen"><i class="fa fa-check"></i><b>10.10</b> Mehrfaktorielle Abbildungen</a><ul>
<li class="chapter" data-level="10.10.1" data-path="visual.html"><a href="visual.html#positionsargument"><i class="fa fa-check"></i><b>10.10.1</b> Positionsargument</a></li>
<li class="chapter" data-level="10.10.2" data-path="visual.html"><a href="visual.html#facets"><i class="fa fa-check"></i><b>10.10.2</b> Facets</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="visual.html"><a href="visual.html#anordnen-mehrerer-graphen"><i class="fa fa-check"></i><b>10.11</b> Anordnen mehrerer Graphen</a></li>
<li class="chapter" data-level="10.12" data-path="visual.html"><a href="visual.html#adapt"><i class="fa fa-check"></i><b>10.12</b> Anpassen des Aussehens</a><ul>
<li class="chapter" data-level="10.12.1" data-path="visual.html"><a href="visual.html#thema"><i class="fa fa-check"></i><b>10.12.1</b> Thema</a></li>
<li class="chapter" data-level="10.12.2" data-path="visual.html"><a href="visual.html#achsenbegrenzungen"><i class="fa fa-check"></i><b>10.12.2</b> Achsenbegrenzungen</a></li>
<li class="chapter" data-level="10.12.3" data-path="visual.html"><a href="visual.html#schriftgröße"><i class="fa fa-check"></i><b>10.12.3</b> Schriftgröße</a></li>
<li class="chapter" data-level="10.12.4" data-path="visual.html"><a href="visual.html#legende"><i class="fa fa-check"></i><b>10.12.4</b> Legende</a></li>
<li class="chapter" data-level="10.12.5" data-path="visual.html"><a href="visual.html#facet-überschriften"><i class="fa fa-check"></i><b>10.12.5</b> Facet Überschriften</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="visual.html"><a href="visual.html#ggsave"><i class="fa fa-check"></i><b>10.13</b> Speichern von Graphen</a></li>
<li class="chapter" data-level="10.14" data-path="visual.html"><a href="visual.html#skalierung-anpassen"><i class="fa fa-check"></i><b>10.14</b> Skalierung anpassen</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inductive.html"><a href="inductive.html"><i class="fa fa-check"></i><b>11</b> Inferenzstatistik</a><ul>
<li class="chapter" data-level="11.1" data-path="inductive.html"><a href="inductive.html#einführung-1"><i class="fa fa-check"></i><b>11.1</b> Einführung</a></li>
<li class="chapter" data-level="11.2" data-path="inductive.html"><a href="inductive.html#normalverteilung-prüfen"><i class="fa fa-check"></i><b>11.2</b> Normalverteilung prüfen</a><ul>
<li class="chapter" data-level="11.2.1" data-path="inductive.html"><a href="inductive.html#q-q-plot"><i class="fa fa-check"></i><b>11.2.1</b> Q-Q Plot</a></li>
<li class="chapter" data-level="11.2.2" data-path="inductive.html"><a href="inductive.html#shapiro-wilk-test"><i class="fa fa-check"></i><b>11.2.2</b> Shapiro-Wilk Test</a></li>
<li class="chapter" data-level="11.2.3" data-path="inductive.html"><a href="inductive.html#kolgomorov-smirnov-test"><i class="fa fa-check"></i><b>11.2.3</b> Kolgomorov-Smirnov Test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="inductive.html"><a href="inductive.html#varianzhomogenität-und-spherizität"><i class="fa fa-check"></i><b>11.3</b> Varianzhomogenität und Spherizität</a><ul>
<li class="chapter" data-level="11.3.1" data-path="inductive.html"><a href="inductive.html#f-test"><i class="fa fa-check"></i><b>11.3.1</b> <em>F</em> Test</a></li>
<li class="chapter" data-level="11.3.2" data-path="inductive.html"><a href="inductive.html#levene-test"><i class="fa fa-check"></i><b>11.3.2</b> Levene Test</a></li>
<li class="chapter" data-level="11.3.3" data-path="inductive.html"><a href="inductive.html#bartletts-test"><i class="fa fa-check"></i><b>11.3.3</b> Bartletts Test</a></li>
<li class="chapter" data-level="11.3.4" data-path="inductive.html"><a href="inductive.html#mauchly-test"><i class="fa fa-check"></i><b>11.3.4</b> Mauchly Test</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="inductive.html"><a href="inductive.html#mittelwertsvergleiche"><i class="fa fa-check"></i><b>11.4</b> Mittelwertsvergleiche</a><ul>
<li class="chapter" data-level="11.4.1" data-path="inductive.html"><a href="inductive.html#gauß-test"><i class="fa fa-check"></i><b>11.4.1</b> Gauß Test</a></li>
<li class="chapter" data-level="11.4.2" data-path="inductive.html"><a href="inductive.html#t-test"><i class="fa fa-check"></i><b>11.4.2</b> <em>t</em> Test</a></li>
<li class="chapter" data-level="11.4.3" data-path="inductive.html"><a href="inductive.html#welch-test"><i class="fa fa-check"></i><b>11.4.3</b> Welch Test</a></li>
<li class="chapter" data-level="11.4.4" data-path="inductive.html"><a href="inductive.html#wilcoxon-test"><i class="fa fa-check"></i><b>11.4.4</b> Wilcoxon Test</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="inductive.html"><a href="inductive.html#varianzanalysen"><i class="fa fa-check"></i><b>11.5</b> Varianzanalysen</a><ul>
<li class="chapter" data-level="11.5.1" data-path="inductive.html"><a href="inductive.html#anova"><i class="fa fa-check"></i><b>11.5.1</b> ANOVA</a></li>
<li class="chapter" data-level="11.5.2" data-path="inductive.html"><a href="inductive.html#repeated"><i class="fa fa-check"></i><b>11.5.2</b> Messwiederholung</a></li>
<li class="chapter" data-level="11.5.3" data-path="inductive.html"><a href="inductive.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>11.5.3</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="inductive.html"><a href="inductive.html#regressionsmodelle"><i class="fa fa-check"></i><b>11.6</b> Regressionsmodelle</a><ul>
<li class="chapter" data-level="11.6.1" data-path="inductive.html"><a href="inductive.html#linregression"><i class="fa fa-check"></i><b>11.6.1</b> Lineare Regression</a></li>
<li class="chapter" data-level="11.6.2" data-path="inductive.html"><a href="inductive.html#hierarchische-regression"><i class="fa fa-check"></i><b>11.6.2</b> Hierarchische Regression</a></li>
<li class="chapter" data-level="11.6.3" data-path="inductive.html"><a href="inductive.html#logit-modelle"><i class="fa fa-check"></i><b>11.6.3</b> Logit Modelle</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="inductive.html"><a href="inductive.html#korrelationsanalysen"><i class="fa fa-check"></i><b>11.7</b> Korrelationsanalysen</a><ul>
<li class="chapter" data-level="11.7.1" data-path="inductive.html"><a href="inductive.html#produkt-moment-korrelation-nach-pearson"><i class="fa fa-check"></i><b>11.7.1</b> Produkt-Moment Korrelation nach Pearson</a></li>
<li class="chapter" data-level="11.7.2" data-path="inductive.html"><a href="inductive.html#rangkorrelation-nach-spearman"><i class="fa fa-check"></i><b>11.7.2</b> Rangkorrelation nach Spearman</a></li>
<li class="chapter" data-level="11.7.3" data-path="inductive.html"><a href="inductive.html#polychoric-korrelation"><i class="fa fa-check"></i><b>11.7.3</b> Polychoric Korrelation</a></li>
<li class="chapter" data-level="11.7.4" data-path="inductive.html"><a href="inductive.html#korrelationstabellen"><i class="fa fa-check"></i><b>11.7.4</b> Korrelationstabellen</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="inductive.html"><a href="inductive.html#contingency"><i class="fa fa-check"></i><b>11.8</b> Kontingenztafeln</a><ul>
<li class="chapter" data-level="11.8.1" data-path="inductive.html"><a href="inductive.html#fishers-exact-test"><i class="fa fa-check"></i><b>11.8.1</b> Fisher’s-Exact Test</a></li>
<li class="chapter" data-level="11.8.2" data-path="inductive.html"><a href="inductive.html#chi2-tests"><i class="fa fa-check"></i><b>11.8.2</b> <span class="math inline">\(\chi^2\)</span>-Tests</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="inductive.html"><a href="inductive.html#post-hoc-tests"><i class="fa fa-check"></i><b>11.9</b> Post-Hoc Tests</a><ul>
<li class="chapter" data-level="11.9.1" data-path="inductive.html"><a href="inductive.html#tukey-honest-significant-difference"><i class="fa fa-check"></i><b>11.9.1</b> Tukey Honest Significant Difference</a></li>
<li class="chapter" data-level="11.9.2" data-path="inductive.html"><a href="inductive.html#pairwise-t-test"><i class="fa fa-check"></i><b>11.9.2</b> Pairwise <em>t</em> Test</a></li>
<li class="chapter" data-level="11.9.3" data-path="inductive.html"><a href="inductive.html#estimated-marginal-means"><i class="fa fa-check"></i><b>11.9.3</b> Estimated Marginal Means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html"><i class="fa fa-check"></i><b>12</b> Latente Variablenmodelle</a><ul>
<li class="chapter" data-level="12.1" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#scree-plot"><i class="fa fa-check"></i><b>12.1</b> Scree Plot</a></li>
<li class="chapter" data-level="12.2" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#naive-hauptkomponentenanalyse"><i class="fa fa-check"></i><b>12.2</b> Naive Hauptkomponentenanalyse</a></li>
<li class="chapter" data-level="12.3" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#maximum-likelihood-faktorenanalyse"><i class="fa fa-check"></i><b>12.3</b> Maximum Likelihood Faktorenanalyse</a></li>
<li class="chapter" data-level="12.4" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#k-means-clustering"><i class="fa fa-check"></i><b>12.4</b> <em>k</em>-Means Clustering</a></li>
<li class="chapter" data-level="12.5" data-path="latente-variablenmodelle.html"><a href="latente-variablenmodelle.html#strukturgleichungsmodelle"><i class="fa fa-check"></i><b>12.5</b> Strukturgleichungsmodelle</a></li>
</ul></li>
<li class="part"><span><b>IV Vertiefung</b></span></li>
<li class="chapter" data-level="13" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>13</b> Datenstrukturen</a><ul>
<li class="chapter" data-level="13.1" data-path="datatypes.html"><a href="datatypes.html#vec"><i class="fa fa-check"></i><b>13.1</b> Vektor</a></li>
<li class="chapter" data-level="13.2" data-path="datatypes.html"><a href="datatypes.html#matrix"><i class="fa fa-check"></i><b>13.2</b> Matrix</a></li>
<li class="chapter" data-level="13.3" data-path="datatypes.html"><a href="datatypes.html#tibble"><i class="fa fa-check"></i><b>13.3</b> Data.frame und tibble</a></li>
<li class="chapter" data-level="13.4" data-path="datatypes.html"><a href="datatypes.html#lists"><i class="fa fa-check"></i><b>13.4</b> Liste</a></li>
<li class="chapter" data-level="13.5" data-path="datatypes.html"><a href="datatypes.html#umwandlung"><i class="fa fa-check"></i><b>13.5</b> Umwandlungen</a></li>
<li class="chapter" data-level="13.6" data-path="datatypes.html"><a href="datatypes.html#objektorientierung"><i class="fa fa-check"></i><b>13.6</b> Objektorientierung</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="reproduzierbare-berichte.html"><a href="reproduzierbare-berichte.html"><i class="fa fa-check"></i><b>14</b> Reproduzierbare Berichte</a><ul>
<li class="chapter" data-level="14.1" data-path="reproduzierbare-berichte.html"><a href="reproduzierbare-berichte.html#markdown"><i class="fa fa-check"></i><b>14.1</b> rMarkdown</a></li>
<li class="chapter" data-level="14.2" data-path="reproduzierbare-berichte.html"><a href="reproduzierbare-berichte.html#tabellen-ausgeben"><i class="fa fa-check"></i><b>14.2</b> Tabellen ausgeben</a><ul>
<li class="chapter" data-level="14.2.1" data-path="reproduzierbare-berichte.html"><a href="reproduzierbare-berichte.html#word-und-pdf-mit-rmarkdown"><i class="fa fa-check"></i><b>14.2.1</b> Word und PDF mit rMarkdown</a></li>
<li class="chapter" data-level="14.2.2" data-path="reproduzierbare-berichte.html"><a href="reproduzierbare-berichte.html#latex"><i class="fa fa-check"></i><b>14.2.2</b> LaTeX</a></li>
<li class="chapter" data-level="14.2.3" data-path="reproduzierbare-berichte.html"><a href="reproduzierbare-berichte.html#grammar-of-tables"><i class="fa fa-check"></i><b>14.2.3</b> Grammar of Tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html"><i class="fa fa-check"></i><b>15</b> Funktionales Programmieren</a><ul>
<li class="chapter" data-level="15.1" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#function"><i class="fa fa-check"></i><b>15.1</b> Funktionen und Functionals</a></li>
<li class="chapter" data-level="15.2" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#lambda"><i class="fa fa-check"></i><b>15.2</b> Anonyme Lambda Funktionen</a></li>
<li class="chapter" data-level="15.3" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#functional"><i class="fa fa-check"></i><b>15.3</b> Iterationen</a><ul>
<li class="chapter" data-level="15.3.1" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#for-loops"><i class="fa fa-check"></i><b>15.3.1</b> For-Loops</a></li>
<li class="chapter" data-level="15.3.2" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#map"><i class="fa fa-check"></i><b>15.3.2</b> Mappen</a></li>
<li class="chapter" data-level="15.3.3" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#apply"><i class="fa fa-check"></i><b>15.3.3</b> Die Apply-Familie</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#nest"><i class="fa fa-check"></i><b>15.4</b> Nesten</a></li>
<li class="chapter" data-level="15.5" data-path="funktionales-programmieren.html"><a href="funktionales-programmieren.html#bedingte-anweisungen"><i class="fa fa-check"></i><b>15.5</b> Bedingte Anweisungen</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="namespace.html"><a href="namespace.html"><i class="fa fa-check"></i><b>16</b> Namespace</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#datensatzerläuterungen"><i class="fa fa-check"></i>Datensatzerläuterungen</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#big-five"><i class="fa fa-check"></i>Big Five</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#tipp-wm"><i class="fa fa-check"></i>Tipp WM</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#indonesisch"><i class="fa fa-check"></i>Indonesisch</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#video"><i class="fa fa-check"></i>Video</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#artists"><i class="fa fa-check"></i>Artists</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#tracks"><i class="fa fa-check"></i>Tracks</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#fitness"><i class="fa fa-check"></i>Fitness</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#statistical-literacy"><i class="fa fa-check"></i>Statistical Literacy</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#übungsverzeichnis"><i class="fa fa-check"></i>Übungsverzeichnis</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#literaturverzeichnis"><i class="fa fa-check"></i>Literaturverzeichnis</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#verwendete-software-versionen"><i class="fa fa-check"></i>Verwendete Software Versionen</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R für empirische Wissenschaften</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="funktionales-programmieren" class="section level1">
<h1><span class="header-section-number">Kapitel 15</span> Funktionales Programmieren</h1>
<p>Im Kern ist R eine funktionale Programmiersprache. Das ermöglicht uns einige mächtige Dinge direkt mithilfe von in R eingebauten Funktionen und Eigenschaften zu machen. Wir werden uns an dieser Stelle verschiedene Einblicke in wichtige Fortgeschrittene Konzepte genehmigen, die Dir als Starthilfe für zeitsparendes und effektives Programmieren dienen werden.</p>
<div id="function" class="section level2">
<h2><span class="header-section-number">15.1</span> Funktionen und Functionals</h2>
<p>Funktionen haben wir bereits das ganze Buch über verwendet. Von der Berechnung von Mittelwerten über die Auswahl von Spalten bis hin zur Visualisierung der Daten. Wenn einem Wort in R eine gewöhnliche Klammer folgt, ist es eine Funktion. Wir werden uns nun anschauen, wie man selbst eigene Funktionen schreibt. Angenommen, wir würden einen Vektor namens <code>vec</code> erstellen.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="funktionales-programmieren.html#cb275-1"></a>vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p>Mit dem Funktionsaufruf <code>mean(vec)</code> könnte man nun den Mittelwert des Vektors berechnen. Nun wollen wir eine eigene Funktion zur Berechnung des Mittelwertes schreiben. Dies können wir mit <code>function()</code> umsetzen. Durch <code>function()</code> wird eine neue Funktion erstellt. Der auszuführende Inhalt muss dabei in geschweiften Klammern stehen, wenn die Funktion eine Zeile übersteigt. Als Argument muss man <code>function()</code> sämtliche Argumente übergeben, die später innerhalb der Funktion verwendet werden sollen. Das Benennen und speichern wird auf die selbe Art und Weise wie bei jeder Variable gemacht. Da der Mittelwert durch das Teilen von der Summe der Werte durch die Anzahl erfolgt, können wir dies mit <code>sum()</code> und <code>length()</code> erreichen.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="funktionales-programmieren.html#cb276-1"></a>mean_own &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb276-2"><a href="funktionales-programmieren.html#cb276-2"></a>  <span class="kw">sum</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb276-3"><a href="funktionales-programmieren.html#cb276-3"></a>}</span></code></pre></div>
<p>Eigene Funktionen kann man nach Speicherung genauso verwenden, wie jene die in <code>base R</code> oder irgendwelchen Packages integriert sind.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="funktionales-programmieren.html#cb277-1"></a><span class="kw">mean_own</span>(vec) </span></code></pre></div>
<pre><code>## [1] 2.8</code></pre>
<p>Nun wollen wir uns noch ein zweites Beispiel ansehen. Dieses mal soll der Zahl, die der Funktion übergeben wird, eine weitere Zahl addiert werden. Diese weitere Zahl (<code>number</code>) kann bei jedem Funktionsaufruf verändert werden. Die Standardeinstellung sei auf 1 festgelegt. Das heißt, dass bei Auslassen des zweiten Arguments <code>number</code> der Zahl <code>x</code> eine 1 hinzugefügt wird.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="funktionales-programmieren.html#cb279-1"></a>add_number &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">number =</span> <span class="dv">1</span>) {</span>
<span id="cb279-2"><a href="funktionales-programmieren.html#cb279-2"></a>  x <span class="op">+</span><span class="st"> </span>number</span>
<span id="cb279-3"><a href="funktionales-programmieren.html#cb279-3"></a>}</span></code></pre></div>
<p>Erst einmal abgespeichert kann diese Funktion ganz normal zum Beispiel innerhalb von <code>mutate()</code> verwendet werden. Um das ganze zu illustrieren, geben wir unserer nagelneuen Funktion als zweites Argument eine 2.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="funktionales-programmieren.html#cb280-1"></a>big_five <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb280-2"><a href="funktionales-programmieren.html#cb280-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb280-3"><a href="funktionales-programmieren.html#cb280-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Extraversion =</span> <span class="kw">add_number</span>(Extraversion, <span class="dv">2</span>)) </span></code></pre></div>
<pre><code>## # A tibble: 200 x 1
##   Extraversion
##          &lt;dbl&gt;
## 1          5  
## 2          5.1
## 3          5.4
## 4          5.3
## # … with 196 more rows</code></pre>
<p>Da R eine vektorisierte Sprache ist, wird gleich der gesamte Vektor, der in der Spalte Extraversion enthalten ist, mit 2 addiert. Innerhalb von <code>mutate_at()</code> könnte man die Funktion ebenfalls aufrufen.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="funktionales-programmieren.html#cb282-1"></a>big_five <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb282-2"><a href="funktionales-programmieren.html#cb282-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb282-3"><a href="funktionales-programmieren.html#cb282-3"></a><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(Extraversion), add_number, <span class="dv">3</span>)</span></code></pre></div>
<p>Funktionals sind Funktionen, die eine Funktion als Argument und einen Vektor als Output haben. Wir werden in Kapitel <a href="funktionales-programmieren.html#map">15.3.2</a> und <a href="funktionales-programmieren.html#apply">15.3.3</a> komplexe Anwendungsfälle von Functionals kennenlernen. Zum Verständnis sei aber zuerst eine Funktion erstellt, die die Berechnung durchführt, die man innerhalb des Funktionsaufrufs festlegt.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="funktionales-programmieren.html#cb283-1"></a>calc &lt;-<span class="st"> </span><span class="cf">function</span>(vektor, fun) {</span>
<span id="cb283-2"><a href="funktionales-programmieren.html#cb283-2"></a>  <span class="kw">fun</span>(data)</span>
<span id="cb283-3"><a href="funktionales-programmieren.html#cb283-3"></a>}</span></code></pre></div>
<p>Dabei ist das erste Argument der zu verwertende Vektor und das zweite die Funktion, die innerhalb der selbst erstellten Funktion angewandt werden soll. In diesem Fall soll der zuvor erstellte Vektor <code>vec</code> summiert werden.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="funktionales-programmieren.html#cb284-1"></a><span class="kw">calc</span>(vec, sum)</span></code></pre></div>
<pre><code>## [1] 29</code></pre>
</div>
<div id="lambda" class="section level2">
<h2><span class="header-section-number">15.2</span> Anonyme Lambda Funktionen</h2>
<p>Anonyme Funktion unterscheiden sich von gewöhnlichen Funktionen nur in einer Hinsicht: sie haben keine Namen. Anstelle der <code>add_number()</code> Funktion aus dem vorherigen Kapitel könnte man die Funktion ebenso gut innerhalb von <code>mutate_at()</code> erstellen. Das ist gerade dann von Vorteil, wenn die Funktion nur in diesem einen Kontext angewendet werden soll und eine extra Erstellung und Speicherung der Funktion mit eigenem Funktionsname nicht zielführend ist.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="funktionales-programmieren.html#cb286-1"></a>big_five <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb286-2"><a href="funktionales-programmieren.html#cb286-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb286-3"><a href="funktionales-programmieren.html#cb286-3"></a><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(Extraversion), <span class="cf">function</span>(x) x <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 200 x 1
##   Extraversion
##          &lt;dbl&gt;
## 1          5  
## 2          5.1
## 3          5.4
## 4          5.3
## # … with 196 more rows</code></pre>
<p>Lambda Funktionen sind eine moderne Art und Weise anonyme Funktionen mithilfe einer Tilde (<code>~</code>) darzustellen. Lambda Funktion wurden die letzten Jahre ähnlich auch in andere Sprachen wie Java 8 integriert. Letzten Endes ist es lediglich nur eine Methode, um Code zu sparen und an Übersichtlichkeit zu gewinnen. Das Argument <code>.x</code> nimmt dabei die Rolle der verwendeten Daten (vorher <code>x</code>) ein. Der Punkt in <code>.x</code> ist an dieser Stelle unabdingbar.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="funktionales-programmieren.html#cb288-1"></a>big_five <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb288-2"><a href="funktionales-programmieren.html#cb288-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb288-3"><a href="funktionales-programmieren.html#cb288-3"></a><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(Extraversion), <span class="op">~</span><span class="st"> </span>.x <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<p>Hier gewinnt man zwar wenig Übersichtlichkeit dazu jedoch, kann es in komplexeren Anwendungsfällen sehr praktisch sein. Die Lambda Funktionen wurden mit dem im <code>tidyverse</code> enthaltenen <code>purrr</code> Package eingeführt. Mittlerweile kann man diese auch wie oben gesehen in Funktionen wie <code>mutate_at()</code> aus <code>dplyr</code> verwenden.</p>
</div>
<div id="functional" class="section level2">
<h2><span class="header-section-number">15.3</span> Iterationen</h2>
<p>Es gibt in der Programmierung die ungeschriebene Regel, dass man maximal drei mal das selbe in leichter Variation Copy &amp; Pasten soll. Wenn man öfter nahezu den identischen Code wieder abruft, sollte man iterative Prozesse in Form von Schleifen verwenden oder seinen Code anderweitig umschreiben. Das ganze hat den Hintergrund, dass Copy &amp; Pasten extrem fehleranfällig und wartungsaufwändig ist. Angenommen, wir werden den <code>big5</code> Datensatz aus Kapitel <a href="visual.html#visual">10</a>. Nun schauen wir uns an, wie die Odds Ratios der Kontingenztafeln aus Kapitel <a href="visual.html#odds">10.8</a> erstellt wurden. Eine Kontingenztafel für die Darstellung der Geschlechter für diejenigen, die eine höher ausgeprägte Extraversion als 3 haben, erhält man mit</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="funktionales-programmieren.html#cb289-1"></a><span class="kw">table</span>(big5<span class="op">$</span>Geschlecht, big5<span class="op">$</span>Extraversion <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   f    66   52
##   m    43   39</code></pre>
<p>Um die Kontingenztafel für jeden Persönlichkeitsfaktor und anschließend die Odds Ratios zu berechnen, müsste man nun für jeden einzeln diesen Befehl ausführen. Gespeichert seien die Ergebnisse in einer Liste.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="funktionales-programmieren.html#cb291-1"></a>ls &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb291-2"><a href="funktionales-programmieren.html#cb291-2"></a>  <span class="kw">table</span>(big5<span class="op">$</span>Geschlecht, big5<span class="op">$</span>Extraversion <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb291-3"><a href="funktionales-programmieren.html#cb291-3"></a>  <span class="kw">table</span>(big5<span class="op">$</span>Geschlecht, big5<span class="op">$</span>Neurotizismus <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb291-4"><a href="funktionales-programmieren.html#cb291-4"></a>  <span class="kw">table</span>(big5<span class="op">$</span>Geschlecht, big5<span class="op">$</span>Vertraeglichkeit <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb291-5"><a href="funktionales-programmieren.html#cb291-5"></a>  <span class="kw">table</span>(big5<span class="op">$</span>Geschlecht, big5<span class="op">$</span>Gewissenhaftigkeit <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb291-6"><a href="funktionales-programmieren.html#cb291-6"></a>  <span class="kw">table</span>(big5<span class="op">$</span>Geschlecht, big5<span class="op">$</span>Offenheit <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb291-7"><a href="funktionales-programmieren.html#cb291-7"></a>)</span></code></pre></div>
<p>Heraus kommt also eine Liste mit 5 Kontingenztafeln – für jeden Persönlichkeitsfaktor eine.</p>
<pre><code>## [[1]]
##    
##     FALSE TRUE
##   f    66   52
##   m    43   39
## 
## [[2]]
##    
##     FALSE TRUE
##   f    47   71
##   m    49   33
## 
## [[3]]
##    
##     FALSE TRUE
##   f    35   83
##   m    25   57
## 
## [[4]]
##    
##     FALSE TRUE
##   f    43   75
##   m    35   47
## 
## [[5]]
##    
##     FALSE TRUE
##   f    25   93
##   m    21   61</code></pre>
<p>Bevor wir uns an die Auswertung mithilfe des Fisher Exact Tests wagen, schauen wir uns an, wie man dieses Copy &amp; Paste von gerade eleganter lösen kann. Die Persönlichkeitsfaktoren seien hierfür in einem Vektor gespeichert.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="funktionales-programmieren.html#cb293-1"></a>Faktors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Extraversion&quot;</span>, <span class="st">&quot;Neurotizismus&quot;</span>, </span>
<span id="cb293-2"><a href="funktionales-programmieren.html#cb293-2"></a>             <span class="st">&quot;Vertraeglichkeit&quot;</span>, <span class="st">&quot;Gewissenhaftigkeit&quot;</span>,</span>
<span id="cb293-3"><a href="funktionales-programmieren.html#cb293-3"></a>             <span class="st">&quot;Offenheit&quot;</span>)</span></code></pre></div>
<div id="for-loops" class="section level3">
<h3><span class="header-section-number">15.3.1</span> For-Loops</h3>
<p>For-Loops wenden die Befehle innerhalb der geschweiften Klammern <strong>für</strong> die angegebene Nummer an Ausführungen an. Die Schleifen werden an dieser Stelle nur erklärt, um das Konzept der iterativen Prozesse besser darzustellen. Selbst solltest Du Dich falls möglich von For-Loops fernhalten und auf die in den nächsten zwei Kapiteln erklärten Funktionen zurückgreifen. Das liegt nicht nur daran, dass For-Loops in R recht langsam sind. Das Problem ist hauptsächlich das hohe Maß an Flexibilität. Während Flexibilität grundsätzlich eine wunderbare Sache ist, resultiert dadurch leider auch viel Spielraum, um Fehler zu machen. Es beginnt schon damit, die Ergebnisliste vorher zu definieren, in die wir unsere 5 Kontingenztafeln abspeichern möchten.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="funktionales-programmieren.html#cb294-1"></a>ls &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Die <code>vector()</code> Funktion ist eine Alternative zu <code>list()</code>, die beim loopen erheblich schneller ist. Das liegt daran, dass die Größe der Liste im vornerein festgelegt wird und somit nicht in jeder Iteration um eins erweitert werden muss. Diese und viele andere Überlegungen werden Dir von Funktionen <code>map()</code> aus dem folgenden Kapitel abgenommen. Nun möchten wir den <code>table()</code> Befehl für jede Kontingenztafel anwenden. Da die Spaltennamen innerhalb des Vektors <code>Faktors</code> als Character gespeichert sind, werden wir an dieser Stelle die Syntax mit den geschweiften Klammern, um auf die Spalten zuzugreifen. Dabei möchten wir aus <code>Faktors</code> das <em>i</em>-te Element haben. Dieser Index <em>i</em> wandert genau wie beim bekannten Summenzeichen von 1 bis zum letzten angegeben Element (hier 5). Die Ergebnisse werden in der zuvor erstellten Liste <code>ls</code> an <em>i</em>-ter Stelle speichern.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="funktionales-programmieren.html#cb295-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb295-2"><a href="funktionales-programmieren.html#cb295-2"></a>  ls[[i]] &lt;-<span class="st"> </span><span class="kw">table</span>(big5[[<span class="st">&quot;Geschlecht&quot;</span>]], big5[[Faktors[i]]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb295-3"><a href="funktionales-programmieren.html#cb295-3"></a>}</span></code></pre></div>
<p>Da Du dies in der Regel selbst nicht so anwenden solltest, wird an dieser Stelle auf das Berechnen der Fisher Exact Tests verzichtet. Ebenfalls sei auf noch flexiblere Alternativen zum for-loop wie <code>while()</code> und <code>repeat()</code> nicht weiter eingegangen.</p>
</div>
<div id="map" class="section level3">
<h3><span class="header-section-number">15.3.2</span> Mappen</h3>
<p>Das Package <code>purrr</code> aus dem <code>tidyverse</code> enthält diverse Funktionen für iterative Prozesse, die <code>map()</code> im Namen haben. Wir konzentrieren uns an dieser Stelle nur auf zwei Vertreter dieser Funktion. Für weitere Informationen über spezielle Vertreter sei auf die Package Dokumentation verwiesen. Das selbe wie vorhin können wir nun ganz einfach wie folgt erreichen.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="funktionales-programmieren.html#cb296-1"></a>ls &lt;-<span class="st"> </span>Faktors <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb296-2"><a href="funktionales-programmieren.html#cb296-2"></a><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">table</span>(big5[[<span class="st">&quot;Geschlecht&quot;</span>]], big5[[.x]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)) </span></code></pre></div>
<p>Durch die lambda Funktion ist die Syntax schön übersichtlich. Das Argument <code>.x</code> innerhalb der doppelten Klammern hinter <code>big5</code> spezifiziert das Element von <code>Faktors</code> in der jeweiligen Iteration – also zuerst das erste, dann das zweite und so weiter. Die Liste <code>ls</code> muss dabei nicht vorher erstellt werden. Diese erstellte Liste verwenden wir nun zum Berechnen des Fisher Exact Test, da uns dort die Odds Ratio (<code>OR</code>) ausgespuckt wird.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="funktionales-programmieren.html#cb297-1"></a>odds_ratios &lt;-<span class="st"> </span>ls <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb297-2"><a href="funktionales-programmieren.html#cb297-2"></a><span class="st">  </span><span class="kw">map_df</span>(<span class="op">~</span><span class="st"> </span><span class="kw">tidy</span>(<span class="kw">fisher.test</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb297-3"><a href="funktionales-programmieren.html#cb297-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Faktor =</span> Faktors) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb297-4"><a href="funktionales-programmieren.html#cb297-4"></a><span class="st">  </span><span class="kw">select</span>(Faktor, <span class="dt">OR =</span> estimate, conf.low, conf.high) </span></code></pre></div>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="funktionales-programmieren.html#cb298-1"></a>odds_ratios</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   Faktor                OR conf.low conf.high
##   &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 Extraversion       1.15     0.628     2.11 
## 2 Neurotizismus      0.448    0.241     0.824
## 3 Vertraeglichkeit   0.962    0.499     1.87 
## 4 Gewissenhaftigkeit 0.771    0.416     1.43 
## # … with 1 more row</code></pre>
<p>Und schon haben wir den Datensatz aus Kapitel <a href="visual.html#odds">10.8</a>. Der Unterschied der Funktion <code>map_df()</code> zum eigentlichen <code>map()</code> ist der, dass die Ergebnisse, falls möglich, direkt in einen <code>tibble</code> umgewandelt werden. Natürlich könnte man auch alles in einer durch die Pipe verbundenen Befehlskette ausführen. Das geht übrigens mit einem for-Loop auch nicht.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="funktionales-programmieren.html#cb300-1"></a>Faktors <span class="op">%&gt;%</span></span>
<span id="cb300-2"><a href="funktionales-programmieren.html#cb300-2"></a><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">table</span>(big5[[<span class="st">&quot;Geschlecht&quot;</span>]], big5[[.x]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb300-3"><a href="funktionales-programmieren.html#cb300-3"></a><span class="st">  </span><span class="kw">map_df</span>(<span class="op">~</span><span class="st"> </span><span class="kw">tidy</span>(<span class="kw">fisher.test</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb300-4"><a href="funktionales-programmieren.html#cb300-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Faktor =</span> Faktors) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb300-5"><a href="funktionales-programmieren.html#cb300-5"></a><span class="st">  </span><span class="kw">select</span>(Faktor, <span class="dt">OR =</span> estimate, conf.low, conf.high) </span></code></pre></div>
<p>Wir haben im Rahmen der Datenvorbereitung das zeilenweise Berechnen des Mittelwertes gelernt. Falls man pro Zeile zu berechnenden Spalten für den Mittelwert nicht im Voraus definiert, ist der Punkt als Platzhalter aufgefallen.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="funktionales-programmieren.html#cb301-1"></a>big_five <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb301-2"><a href="funktionales-programmieren.html#cb301-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Offenheit =</span> <span class="kw">rowMeans</span>(<span class="kw">select</span>(., O1<span class="op">:</span>O10)))</span></code></pre></div>
<p>Im Grund genommen macht dieser nichts anderes als <code>.x</code> im <code>purrr</code> Package in den <code>map()</code> Funktionen. Der Punkt nimmt das vorhergehende Argument. In dem Fall den Datensatz, der über die Pipe weitergegeben wird. Es ist also ein Feature des Packages <code>magrittr</code> und der darin enthaltenen Pipe. Dies ist im Übrigen nur notwendig, weil mehrere Funktionsaufrufe ineinander verschachtelt sind, so dass <code>select()</code> keine automatische Möglichkeit besitzt, selbst nachzuvollziehen, welcher Datensatz zwei Ebenen zuvor weitergegeben wurde.</p>
</div>
<div id="apply" class="section level3">
<h3><span class="header-section-number">15.3.3</span> Die Apply-Familie</h3>
<p>Grundsätzlich ist das im vorherigen Kapitel kennengelernte <code>map()</code> eine Alternative zur Apply-Familie in <code>base R</code>. Es gibt verschiedene Varianten. Wir schauen uns <code>lapply()</code> (für list apply) und das normale <code>apply()</code> an. Gerade letzteres bietet eine Funktion, die das <code>purrr</code> Package bietet, aber dazu später mehr. Die Funktion <code>lapply()</code> macht genau das selbe, wie <code>map()</code>. Nur kann hier keine Lambda Funktion verwendet werden, wodurch der Ausdruck unwesentlich unlesbarer wird.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="funktionales-programmieren.html#cb302-1"></a><span class="kw">lapply</span>(Faktors, <span class="cf">function</span>(x) { </span>
<span id="cb302-2"><a href="funktionales-programmieren.html#cb302-2"></a>   <span class="kw">table</span>(big5[[<span class="st">&quot;Geschlecht&quot;</span>]], big5[[x]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb302-3"><a href="funktionales-programmieren.html#cb302-3"></a>  }</span>
<span id="cb302-4"><a href="funktionales-programmieren.html#cb302-4"></a>)</span></code></pre></div>
<p>Man könnte es auch in eine Zeile schreiben, nur sollte man es sich angewöhnen, nicht zu weite Zeilen zu haben. In einer Zeile wären die geschweiften wie bereits bekannt dann obsolet. Nun möchten wir uns wie besprochen anschauen, wie man alternative zeilenweise operierende Funktionen wie <code>rowMeans()</code> zur Berechnung des Mittelwertes über mehrere Spalten selbst erstellen kann. Schließlich ist es häufig genug der Fall, ordinal skalierte Variablen im Datensatz zu haben, bei denen es unangebracht ist, einen Mittelwert zu berechnen. Eine Funktion <code>rowMedian()</code> ist leider nicht in <code>base R</code> integriert. Also schaffen wir uns selbst Abhilfe. Zuerst legen wir die auszurechnen Spalten der Übersichtshalber vorab als <code>mean_vars</code> fest.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="funktionales-programmieren.html#cb303-1"></a>mean_vars &lt;-<span class="st"> </span>big5 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb303-2"><a href="funktionales-programmieren.html#cb303-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion<span class="op">:</span>Offenheit)</span></code></pre></div>
<p>Am Ende des Kapitel <a href="datenvorbereitung.html#tidyverse">7.1</a> haben wir gelernt, wie man die <code>rowMeans()</code> Funktion anwendet.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="funktionales-programmieren.html#cb304-1"></a>big5 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-2"><a href="funktionales-programmieren.html#cb304-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Mean =</span> <span class="kw">rowMeans</span>(mean_vars)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-3"><a href="funktionales-programmieren.html#cb304-3"></a><span class="st">  </span><span class="kw">select</span>(Mean)</span></code></pre></div>
<p>Zur Berechnung des Medians benötigen wir <code>apply()</code>. Besagte Funktion wendet eine bestimmte Funktion <code>FUN</code> entweder auf alle Zeilen (<code>MARGIN = 1</code>) oder auf alle Spalten (<code>MARGIN = 2</code>) an. Das erste Argument ist der Datensatz. Eingebettet in eine Funktion erhält man nun eine Funktion zur Berechnung des Medians für alle Zeilen.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="funktionales-programmieren.html#cb305-1"></a>rowMedian &lt;-<span class="st"> </span><span class="cf">function</span>(data) {</span>
<span id="cb305-2"><a href="funktionales-programmieren.html#cb305-2"></a>  <span class="kw">apply</span>(data, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> median)</span>
<span id="cb305-3"><a href="funktionales-programmieren.html#cb305-3"></a>}</span></code></pre></div>
<p>Erst einmal in einer Variable gespeichert, kann <code>rowMedian()</code> genau auf die selbe Art und Weise eingesetzt werden.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="funktionales-programmieren.html#cb306-1"></a>big5 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-2"><a href="funktionales-programmieren.html#cb306-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Mean =</span> <span class="kw">rowMeans</span>(mean_vars),</span>
<span id="cb306-3"><a href="funktionales-programmieren.html#cb306-3"></a>         <span class="dt">Median =</span> <span class="kw">rowMedian</span>(mean_vars)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-4"><a href="funktionales-programmieren.html#cb306-4"></a><span class="st">  </span><span class="kw">select</span>(Mean, Median)</span></code></pre></div>
<pre><code>## # A tibble: 200 x 2
##    Mean Median
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1  3.04    3.3
## 2  3.22    3.1
## 3  3.12    3.2
## 4  3.4     3.3
## # … with 196 more rows</code></pre>
<p>Auf diese Art und Weise kann jeder Funktion zeilenweise angewandt werden. Der besseren Übersichtlichkeit halber sollte man die Funktion, die man dem Argument <code>FUN</code> übergibt, im vornerein bereits definiert und gespeichert haben. Um <code>rowMedian()</code> auch so flexibel wie sein Mittelwertsäquivalent zu machen, fügen wir noch drei Punkte (<code>...</code>) als Argument hinzu. Diese drei Punkte stehen für beliebig viele Argumente, die der Funktion getrennt von einem Komma (zum Beispiel <code>na.rm = TRUE</code>) übergeben werden sollen.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="funktionales-programmieren.html#cb308-1"></a>rowMedian &lt;-<span class="st"> </span><span class="cf">function</span>(data, ...) {</span>
<span id="cb308-2"><a href="funktionales-programmieren.html#cb308-2"></a>  <span class="kw">apply</span>(data, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> median, ...)</span>
<span id="cb308-3"><a href="funktionales-programmieren.html#cb308-3"></a>}</span></code></pre></div>
</div>
</div>
<div id="nest" class="section level2">
<h2><span class="header-section-number">15.4</span> Nesten</h2>
<p>Durch die Funktion <code>nest()</code> können innerhalb von Zellen eines <code>tibbles</code> Datenstrukturen jeder Art innerhalb eingenistet werden. Um das Konzept zu illustrieren, muss der Datensatz zuerst in ein langes Format umgewandelt werden (siehe Kapitel <a href="datenvorbereitung.html#tidy">7.8</a>).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="funktionales-programmieren.html#cb309-1"></a>df1 &lt;-<span class="st"> </span>big5 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb309-2"><a href="funktionales-programmieren.html#cb309-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(</span>
<span id="cb309-3"><a href="funktionales-programmieren.html#cb309-3"></a>    <span class="dt">cols =</span> Extraversion<span class="op">:</span>Offenheit,</span>
<span id="cb309-4"><a href="funktionales-programmieren.html#cb309-4"></a>    <span class="dt">names_to =</span> <span class="st">&quot;Faktor&quot;</span>,</span>
<span id="cb309-5"><a href="funktionales-programmieren.html#cb309-5"></a>    <span class="dt">values_to =</span> <span class="st">&quot;Wert&quot;</span></span>
<span id="cb309-6"><a href="funktionales-programmieren.html#cb309-6"></a>  )</span></code></pre></div>
<p>Nun möchten wir den Datensatz nach den Persönlichkeitsfaktoren unterteilen. Dafür müssen wir lediglich dem <code>data</code> Argument der Funktion <code>nest()</code> minus den Variablennamen (hier Faktor) übergeben.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="funktionales-programmieren.html#cb310-1"></a>df1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb310-2"><a href="funktionales-programmieren.html#cb310-2"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">data =</span> <span class="op">-</span>Faktor)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   Faktor             data              
##   &lt;chr&gt;              &lt;list&gt;            
## 1 Extraversion       &lt;tibble [200 × 4]&gt;
## 2 Neurotizismus      &lt;tibble [200 × 4]&gt;
## 3 Vertraeglichkeit   &lt;tibble [200 × 4]&gt;
## 4 Gewissenhaftigkeit &lt;tibble [200 × 4]&gt;
## # … with 1 more row</code></pre>
<p>Das Resultat ist ein <code>tibble</code> mit 5 Zeilen (für jeden Persönlichkeitsfaktor eine) und 2 Spalten. Die zweite Spalte <code>data</code> beinhaltet in jeder Zelle einen eigenen Datensatz mit 200 Zeilen und 4 Spalten. Die Spalte selbst beinhaltet nichts anderes als eine Liste. Angenommen, wir speichern das vorherige Ergebnis als <code>nested_df</code>. Dann können wir mit doppelten Klammern (siehe Kapitel <a href="datatypes.html#lists">13.4</a>) auf die Listenelemente zugreifen.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="funktionales-programmieren.html#cb312-1"></a>nested_df[[<span class="dv">2</span>]]</span></code></pre></div>
<p>An dieser Stelle sei zur bessern Übersichtlichkeit lediglich der erste eingenestete Datensatz aus dem ersten Listenelement ausgegeben.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="funktionales-programmieren.html#cb313-1"></a>nested_df[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## # A tibble: 200 x 4
##   Alter Geschlecht Herkunft  Wert
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
## 1    36 m          DE         3  
## 2    30 f          US         3.1
## 3    23 m          US         3.4
## 4    54 m          US         3.3
## # … with 196 more rows</code></pre>
<p>Dieser beinhaltet den Datensatz nur für Extraversion. Es kommt also das selbe heraus, als würde man die Funktion <code>filter()</code> verwenden, mit dem Unterschied das für jede Ausprägungsstufe der Persönlichkeitsfaktoren der Datensatz gefiltert wird. Innerhalb dieser eingenisteten Listenelement kann sich alles befinden – auch statistische Ergebnisobjekte. Man kann nun auf jede dieser Zellen mithilfe von <code>map()</code> (siehe Kapitel <a href="funktionales-programmieren.html#map">15.3.2</a>) beispielsweise ein lineares Modell (siehe Kapitel <a href="inductive.html#linregression">11.6.1</a>) anwenden.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="funktionales-programmieren.html#cb315-1"></a>df1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb315-2"><a href="funktionales-programmieren.html#cb315-2"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">data =</span> <span class="op">-</span>Faktor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb315-3"><a href="funktionales-programmieren.html#cb315-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(Wert <span class="op">~</span><span class="st"> </span>Alter <span class="op">+</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> .)),</span>
<span id="cb315-4"><a href="funktionales-programmieren.html#cb315-4"></a>         <span class="dt">results =</span> <span class="kw">map</span>(fit, tidy))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   Faktor             data               fit    results         
##   &lt;chr&gt;              &lt;list&gt;             &lt;list&gt; &lt;list&gt;          
## 1 Extraversion       &lt;tibble [200 × 4]&gt; &lt;lm&gt;   &lt;tibble [3 × 5]&gt;
## 2 Neurotizismus      &lt;tibble [200 × 4]&gt; &lt;lm&gt;   &lt;tibble [3 × 5]&gt;
## 3 Vertraeglichkeit   &lt;tibble [200 × 4]&gt; &lt;lm&gt;   &lt;tibble [3 × 5]&gt;
## 4 Gewissenhaftigkeit &lt;tibble [200 × 4]&gt; &lt;lm&gt;   &lt;tibble [3 × 5]&gt;
## # … with 1 more row</code></pre>
<p>Nun sehen wir in der neuen Spalte <code>fit</code> die <code>lm</code> Ergebnisobjekte für jeden Persönlichkeitsfaktor und in <code>results</code> jeweils einen <code>tibble</code> mit der Zusammenfassung der wichtigsten Kennwerte. Um auf diese Kennwerte zuzugreifen, muss die Spalte <code>results</code> noch mit der Funktion <code>unnest()</code> <em>entnestet</em> werden. Zur besseren Übersichtlichkeit werden nur die Faktoren, der Term, der <span class="math inline">\(\beta\)</span>-Koeffizient und der p-Wert.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="funktionales-programmieren.html#cb317-1"></a>df1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-2"><a href="funktionales-programmieren.html#cb317-2"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">data =</span> <span class="op">-</span>Faktor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-3"><a href="funktionales-programmieren.html#cb317-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(Wert <span class="op">~</span><span class="st"> </span>Alter <span class="op">+</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> .)),</span>
<span id="cb317-4"><a href="funktionales-programmieren.html#cb317-4"></a>         <span class="dt">results =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-5"><a href="funktionales-programmieren.html#cb317-5"></a><span class="st">  </span><span class="kw">unnest</span>(results) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-6"><a href="funktionales-programmieren.html#cb317-6"></a><span class="st">  </span><span class="kw">select</span>(Faktor, term, <span class="dt">beta =</span> estimate, p.value)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 4
##   Faktor        term            beta   p.value
##   &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
## 1 Extraversion  (Intercept)  3.15    1.93e-112
## 2 Extraversion  Alter       -0.00390 7.15e-  2
## 3 Extraversion  Geschlechtm  0.0686  1.67e-  1
## 4 Neurotizismus (Intercept)  3.59    4.17e- 74
## # … with 11 more rows</code></pre>
</div>
<div id="bedingte-anweisungen" class="section level2">
<h2><span class="header-section-number">15.5</span> Bedingte Anweisungen</h2>
<p>Wir haben bedingte Anweisungen bereits in Kapitel <a href="datenvorbereitung.html#tidyverse">7.1</a> kennengelernt. Und zwar haben wir mit <code>case_when()</code> eine neue Spalte erstellt, deren Werte davon abhingen, ob die jeweils vorgegebene Bedingungen zutrifft. Möchte man beispielsweise die Ausprägung von Extraversion in hoch und niedrig einteilen je nachdem, ob der Wert in der Spalte <code>Extraversion</code> größer oder kleiner als 3 ist, könnte man <code>case_when()</code> wie bereits gelernt innerhalb von <code>mutate()</code> anwenden.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="funktionales-programmieren.html#cb319-1"></a>big5 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb319-2"><a href="funktionales-programmieren.html#cb319-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb319-3"><a href="funktionales-programmieren.html#cb319-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Auspraegung =</span> <span class="kw">case_when</span>(</span>
<span id="cb319-4"><a href="funktionales-programmieren.html#cb319-4"></a>    Extraversion <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;hoch&quot;</span>, </span>
<span id="cb319-5"><a href="funktionales-programmieren.html#cb319-5"></a>    Extraversion <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;niedrig&quot;</span></span>
<span id="cb319-6"><a href="funktionales-programmieren.html#cb319-6"></a>  ))</span></code></pre></div>
<pre><code>## # A tibble: 200 x 2
##   Extraversion Auspraegung
##          &lt;dbl&gt; &lt;chr&gt;      
## 1          3   niedrig    
## 2          3.1 hoch       
## 3          3.4 hoch       
## 4          3.3 hoch       
## # … with 196 more rows</code></pre>
<p>Alternativ kann man das selbe mit <code>ifelse()</code> erreichen. Der Unterschied der beiden Funktionen besteht darin, dass <code>ifelse()</code> nur zwei Bedingungen prüfen kann. Möchte man mehrere Bedingungen einbauen, müsste man die verschiedenen <code>ifelse()</code> Befehle ineinander verschachteln.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="funktionales-programmieren.html#cb321-1"></a>big5 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb321-2"><a href="funktionales-programmieren.html#cb321-2"></a><span class="st">  </span><span class="kw">select</span>(Extraversion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb321-3"><a href="funktionales-programmieren.html#cb321-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Auspraegung =</span> <span class="kw">ifelse</span>(</span>
<span id="cb321-4"><a href="funktionales-programmieren.html#cb321-4"></a>    Extraversion <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb321-5"><a href="funktionales-programmieren.html#cb321-5"></a>    <span class="dt">yes =</span> <span class="st">&quot;hoch&quot;</span>, </span>
<span id="cb321-6"><a href="funktionales-programmieren.html#cb321-6"></a>    <span class="dt">no =</span> <span class="st">&quot;niedrig&quot;</span></span>
<span id="cb321-7"><a href="funktionales-programmieren.html#cb321-7"></a>  ))</span></code></pre></div>
<p>Tatsächlich ist <code>case_when()</code> nichts anderes als eine angenehm zu bedienende Implementation verschachtelter <code>ifelse()</code> Befehle. Grundsätzlich bietet es also keinen Vorteil zu <code>ifelse()</code> zu greifen. Es wird an dieser Stelle trotzdem eingeführt, da dies die vektorisierte Variante der klassischen bedingten Programmierlogik ist, die in jede Programmiersprache implementiert ist. Vektorisiert bedeutet hier, dass man der Funktion direkt einen gesamten Vektor übergeben kann und für jeden Wert innerhalb dieses Vektors geprüft wird, ob die Bedingung zutrifft oder nicht und dementsprechend einen der beiden festgelegten Werte zuweist. Die klassische if-else Verzweigung sei an folgenden Beispiel illustriert. Angenommen, Du sollst ein Stück Obst für Deine Partnerin oder Deinen Partner. Dieser oder diese mag Äpfel sehr gerne, Birnen findet er oder sie eklig und wenn Du etwas anderes mitbringst, zweifelt er oder sie daran, ob Du überhaupt weißt, was Obst genau ist. Wir kaufen einen Apfel und weisen der Variable <code>obst</code> demnach den Character <code>apfel</code> zu.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="funktionales-programmieren.html#cb322-1"></a>obst &lt;-<span class="st"> &quot;apfel&quot;</span></span></code></pre></div>
<p>Nun können wir die Antwort der anderen Person simulieren. <strong>Wenn</strong> das Stück Obst ein Apfel ist, sagt die Person <em>Mhhh, lecker</em> oder <strong>sonst</strong> <strong>wenn</strong> es eine Birne ist <em>Bah, eklig</em> und <strong>ansonsten</strong> <em>Iss mehr Obst</em>.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="funktionales-programmieren.html#cb323-1"></a><span class="cf">if</span> (obst <span class="op">==</span><span class="st"> &quot;apfel&quot;</span>) {</span>
<span id="cb323-2"><a href="funktionales-programmieren.html#cb323-2"></a>  <span class="kw">print</span>(<span class="st">&quot;Mhhh, lecker!&quot;</span>)</span>
<span id="cb323-3"><a href="funktionales-programmieren.html#cb323-3"></a>} <span class="cf">else</span> <span class="cf">if</span> (obst <span class="op">==</span><span class="st"> &quot;birne&quot;</span>) {</span>
<span id="cb323-4"><a href="funktionales-programmieren.html#cb323-4"></a>  <span class="kw">print</span>(<span class="st">&quot;Bah, eklig&quot;</span>)</span>
<span id="cb323-5"><a href="funktionales-programmieren.html#cb323-5"></a>} <span class="cf">else</span> {</span>
<span id="cb323-6"><a href="funktionales-programmieren.html#cb323-6"></a>  <span class="kw">print</span>(<span class="st">&quot;Iss mehr obst&quot;</span>)</span>
<span id="cb323-7"><a href="funktionales-programmieren.html#cb323-7"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Mhhh, lecker!&quot;</code></pre>
<p>Natürlich macht diese Anwendung von if-else Verzweigungen herzlich wenig Sinn. Aber falls Du möchtest, dass bestimmter Code nur unter bestimmten Bedingungen ausgeführt wird, ist dies unerlässlich. Tatsächlich ist das sicher eines der am häufigsten verwendeten Programmierkonzepte überhaupt. In der Datenanalyse selbst benötigen wir nur die erweiterte vektorisierte Version <code>case_when()</code>, weswegen dieser grundsätzlich sehr wichtige Teil einer Programmiersprache eines der letzten Kapitel darstellt. Eine Alternative zu if-else Verzweigungen ist <code>switch()</code>, welches in R nur Character als Bedingungen prüfen kann. Da in den meisten Anwendungsfällen kein Vorteil durch <code>switch()</code> vorhanden ist, sei auf dessen weitere Erklärung verzichtet.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reproduzierbare-berichte.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="namespace.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toc_depth": 3,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
